{"version":3,"sources":["webpack:///./src/components/speak/SpeakMask.vue?f174","webpack:///./src/components/speak/SpeakBottom.vue?68ae","webpack:///src/components/speak/SpeakBottom.vue","webpack:///./src/components/speak/SpeakBottom.vue?a86f","webpack:///./src/components/speak/SpeakBottom.vue","webpack:///./src/components/speak/SpeakMask.vue?8725","webpack:///src/components/speak/SpeakMask.vue","webpack:///./src/components/speak/SpeakMask.vue?4662","webpack:///./src/components/speak/SpeakMask.vue","webpack:///./src/views/store/StoreSpeaking.vue?8b85","webpack:///./src/components/speak/SpeakPlaying.vue?2424","webpack:///src/views/store/StoreSpeaking.vue","webpack:///./src/components/speak/SpeakPlaying.vue?4796","webpack:///src/components/speak/SpeakPlaying.vue","webpack:///./src/components/speak/SpeakPlaying.vue?2682","webpack:///./src/components/speak/SpeakPlaying.vue","webpack:///./src/components/speak/SpeakBottom.vue?709d","webpack:///./src/views/store/StoreSpeaking.vue?b753","webpack:///./src/views/store/StoreSpeaking.vue?f21d","webpack:///./src/views/store/StoreSpeaking.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","class","showPlay","on","$event","stopPropagation","preventDefault","onPlayingCardClick","togglePlay","isPlaying","_v","_s","chapter","label","currentSectionIndex","currentSectionTotal","_e","playInfo","currentMinute","currentSecond","totalMinute","totalSecond","addOrRemoveShelf","inBookShelf","$t","staticRenderFns","component","attrs","directives","name","rawName","value","expression","hide","title","ref","domProps","progress","onProgressChange","target","onProgressInput","leftMinute","leftSecond","prev","next","_l","item","index","key","refInFor","style","back","scrollBottom","disableScroll","onScroll","cover","author","desc","toggleContent","ifShowContent","navigation","speak","playingIndex","onCanPlay","onTimeUpdate","onAudioEnded","_m","book","section","updateText"],"mappings":"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","file":"js/chunk-ce2d60b0.d862c1d2.js","sourcesContent":["export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@10.1.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakMask.vue?vue&type=style&index=0&id=90471c68&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bottom-wrapper\",class:{'hide-play': !_vm.showPlay}},[(_vm.showPlay)?_c('div',{staticClass:\"bottom-playing-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onPlayingCardClick($event)}}},[_c('div',{staticClass:\"bottom-playing-left\"},[_c('div',{staticClass:\"icon-play-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.togglePlay($event)}}},[(!_vm.isPlaying)?_c('span',{staticClass:\"icon-play_go\"}):_c('span',{staticClass:\"icon-play_pause\"})])]),_c('div',{staticClass:\"bottom-playing-right\"},[_c('div',{staticClass:\"bottom-playing-chapter-text\"},[_c('span',{staticClass:\"chapter-label\"},[_vm._v(_vm._s(_vm.chapter ? _vm.chapter.label : ''))]),(_vm.currentSectionIndex && _vm.currentSectionTotal)?_c('span',{staticClass:\"bottom-playing-page-text\"},[_vm._v(\"( \"+_vm._s(_vm.currentSectionIndex)+\" / \"+_vm._s(_vm.currentSectionTotal)+\" )\")]):_vm._e()]),_c('div',{staticClass:\"bottom-playing-page-text\"},[_vm._v(_vm._s(_vm.playInfo ? _vm.playInfo.currentMinute : '00')+\":\"+_vm._s(_vm.playInfo ? _vm.playInfo.currentSecond : '00')+\" / \"+_vm._s(_vm.playInfo ? _vm.playInfo.totalMinute : '00')+\":\"+_vm._s(_vm.playInfo ? _vm.playInfo.totalSecond : '00'))])])]):_vm._e(),_c('div',{staticClass:\"bottom-btn-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.addOrRemoveShelf()}}},[(_vm.inBookShelf)?_c('span',{staticClass:\"icon-uniE90D\"}):_vm._e(),_c('span',{staticClass:\"bottom-btn-text\"},[_vm._v(\" \"+_vm._s(_vm.inBookShelf ? _vm.$t('detail.isAddedToShelf') : _vm.$t('detail.addOrRemoveShelf'))+\" \")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"bottom-wrapper\" :class=\"{'hide-play': !showPlay}\">\r\n    <div class=\"bottom-playing-wrapper\" @click.stop.prevent=\"onPlayingCardClick\" v-if=\"showPlay\">\r\n      <div class=\"bottom-playing-left\">\r\n        <div class=\"icon-play-wrapper\" @click.stop.prevent=\"togglePlay\">\r\n          <span class=\"icon-play_go\" v-if=\"!isPlaying\"></span>\r\n          <span class=\"icon-play_pause\" v-else></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"bottom-playing-right\">\r\n        <div class=\"bottom-playing-chapter-text\">\r\n          <span class=\"chapter-label\">{{chapter ? chapter.label : ''}}</span>\r\n          <span class=\"bottom-playing-page-text\" v-if=\"currentSectionIndex && currentSectionTotal\">( {{currentSectionIndex}} / {{currentSectionTotal}} )</span>\r\n        </div>\r\n        <div class=\"bottom-playing-page-text\">{{playInfo ? playInfo.currentMinute : '00'}}:{{playInfo ? playInfo.currentSecond : '00'}} / {{playInfo ? playInfo.totalMinute : '00'}}:{{playInfo ? playInfo.totalSecond : '00'}}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"bottom-btn-wrapper\" @click.stop.prevent=\"addOrRemoveShelf()\">\r\n      <span class=\"icon-uniE90D\" v-if=\"inBookShelf\"></span>\r\n      <span class=\"bottom-btn-text\">\r\n        {{inBookShelf ? $t('detail.isAddedToShelf') : $t('detail.addOrRemoveShelf')}}\r\n      </span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    props: {\r\n      chapter: Object,\r\n      currentSectionIndex: Number,\r\n      currentSectionTotal: Number,\r\n      showPlay: Boolean,\r\n      isPlaying: Boolean,\r\n      playInfo: Object,\r\n      inBookShelf: Boolean\r\n    },\r\n    methods: {\r\n      togglePlay() {\r\n        this.$parent.togglePlay()\r\n      },\r\n      onPlayingCardClick() {\r\n        this.$emit('onPlayingCardClick')\r\n      },\r\n      addOrRemoveShelf() {\r\n        this.$parent.addOrRemoveShelf()\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import \"../../assets/styles/global\";\r\n\r\n  .bottom-wrapper {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    z-index: 110;\r\n    width: 100%;\r\n    height: px2rem(116);\r\n    background: white;\r\n    box-shadow: 0 px2rem(-2) px2rem(2) 0 rgba(0, 0, 0, .1);\r\n    &.hide-play {\r\n      height: px2rem(52);\r\n    }\r\n    .bottom-playing-wrapper {\r\n      display: flex;\r\n      width: 100%;\r\n      height: px2rem(64);\r\n      .bottom-playing-left {\r\n        flex: 0 0 px2rem(70);\r\n        width: px2rem(70);\r\n        @include center;\r\n        .icon-play-wrapper {\r\n          flex: 0 0 px2rem(100);\r\n          @include center;\r\n          &:active {\r\n            opacity: .5;\r\n          }\r\n          .icon-play_go {\r\n            font-size: px2rem(40);\r\n            color: $color-blue;\r\n          }\r\n          .icon-play_pause {\r\n            font-size: px2rem(40);\r\n            color: $color-blue;\r\n          }\r\n        }\r\n      }\r\n      .bottom-playing-right {\r\n        flex: 1;\r\n        padding-right: px2rem(15);\r\n        box-sizing: border-box;\r\n        @include columnLeft;\r\n        .bottom-playing-chapter-text {\r\n          max-width: px2rem(305);\r\n          color: #333;\r\n          font-size: px2rem(16);\r\n          line-height: px2rem(19);\r\n          @include ellipsis;\r\n        }\r\n        .bottom-playing-page-text {\r\n          color: #666;\r\n          font-size: px2rem(10);\r\n          margin-top: px2rem(5);\r\n        }\r\n      }\r\n    }\r\n    .bottom-btn-wrapper {\r\n      width: 100%;\r\n      height: px2rem(52);\r\n      border-top: px2rem(1) solid #eee;\r\n      box-sizing: border-box;\r\n      @include center;\r\n      .bottom-btn-text {\r\n        font-size: px2rem(14);\r\n        color: $color-blue;\r\n        font-weight: bold;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakBottom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakBottom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpeakBottom.vue?vue&type=template&id=100e51a5&scoped=true&\"\nimport script from \"./SpeakBottom.vue?vue&type=script&lang=js&\"\nexport * from \"./SpeakBottom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpeakBottom.vue?vue&type=style&index=0&id=100e51a5&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"100e51a5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"fade\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.visible),expression:\"visible\"}],staticClass:\"book-speak-mask-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.hide($event)}}},[_c('transition',{attrs:{\"name\":\"popup-slide-up\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.speakCardVisible),expression:\"speakCardVisible\"}],staticClass:\"book-speak-mask-card-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.hide($event)}}},[_c('div',{staticClass:\"pulldown-icon-wrapper\",on:{\"click\":_vm.hide}},[_c('span',{staticClass:\"icon-pull_down\"})]),_c('div',{staticClass:\"card-title-wrapper\"},[_c('div',{staticClass:\"icon-speak-wrapper\"},[_c('span',{staticClass:\"icon-speak\"})]),_c('div',{staticClass:\"speak-title-wrapper\"},[_c('span',{staticClass:\"speak-title\"},[_vm._v(_vm._s(_vm.$t('speak.voice')))])]),_c('div',{staticClass:\"read-fulltext-wrapper\"},[_c('span',{staticClass:\"read-fulltext\"},[_vm._v(_vm._s(_vm.$t('speak.read')))])])]),_c('div',{staticClass:\"card-section-title-wrapper\"},[_c('div',{staticClass:\"card-section-title-text\"},[_vm._v(_vm._s(_vm.title))]),(_vm.currentSectionIndex)?_c('div',{staticClass:\"card-section-sub-title-text\"},[_vm._v(_vm._s(_vm.currentSectionIndex)+\" / \"+_vm._s(_vm.currentSectionTotal)+\" \")]):_vm._e()]),_c('div',{staticClass:\"setting-progress\"},[_c('div',{staticClass:\"progress-wrapper\"},[_c('input',{ref:\"progress\",staticClass:\"progress\",attrs:{\"type\":\"range\",\"max\":\"100\",\"min\":\"0\",\"step\":\"1\"},domProps:{\"value\":_vm.progress},on:{\"change\":function($event){return _vm.onProgressChange($event.target.value)},\"input\":function($event){return _vm.onProgressInput($event.target.value)}}})]),_c('div',{staticClass:\"progress-text\"},[_c('div',{staticClass:\"progress-text-current\"},[_vm._v(_vm._s(_vm.playInfo ? _vm.playInfo.currentMinute : '00')+\":\"+_vm._s(_vm.playInfo ? _vm.playInfo.currentSecond : '00')+\" \")]),_c('div',{staticClass:\"progress-text-left\"},[_vm._v(\"-\"+_vm._s(_vm.playInfo ? _vm.playInfo.leftMinute : '00')+\":\"+_vm._s(_vm.playInfo ? _vm.playInfo.leftSecond : '00')+\" \")])])]),_c('div',{staticClass:\"playing-wrapper\"},[_c('div',{staticClass:\"icon-settings-wrapper\"},[_c('span',{staticClass:\"icon-settings\"}),_c('div',{staticClass:\"settings-text\"},[_vm._v(_vm._s(_vm.$t('speak.settings')))])]),_c('span',{staticClass:\"icon-play_backward\",class:{'not-use': _vm.currentSectionIndex <= 1},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.prev($event)}}}),_c('div',{staticClass:\"icon-play-wrapper\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.togglePlay($event)}}},[(!_vm.isPlaying)?_c('span',{staticClass:\"icon-play_go\"}):_c('span',{staticClass:\"icon-play_pause\"})]),_c('span',{staticClass:\"icon-play_forward\",class:{'not-use': _vm.currentSectionIndex >= _vm.currentSectionTotal},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.next($event)}}}),_c('div',{staticClass:\"icon-clock-wrapper\"},[_c('span',{staticClass:\"icon-clock\"}),_c('div',{staticClass:\"clock-text\"},[_vm._v(_vm._s(_vm.$t('speak.timing')))])])]),_c('div',{staticClass:\"read-apply-wrapper\"},[_vm._v(\" \"+_vm._s(_vm.$t('speak.apply'))+\" \")]),_c('div',{staticClass:\"read-title-wrapper\"},[_c('span',{staticClass:\"line\"}),_c('div',{staticClass:\"read-title-text\"},[_vm._v(_vm._s(_vm.$t('speak.current')))]),_c('span',{staticClass:\"line\"})]),_c('div',{ref:\"bookWrapper\",staticClass:\"book-wrapper\"},[_c('div',{attrs:{\"id\":\"book-read\"}})])])])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <transition name=\"fade\">\r\n    <div class=\"book-speak-mask-wrapper\" @click.stop.prevent=\"hide\" v-show=\"visible\">\r\n      <transition name=\"popup-slide-up\">\r\n        <div class=\"book-speak-mask-card-wrapper\" v-show=\"speakCardVisible\" @click.stop.prevent=\"hide\">\r\n          <div class=\"pulldown-icon-wrapper\" @click=\"hide\">\r\n            <span class=\"icon-pull_down\"></span>\r\n          </div>\r\n          <div class=\"card-title-wrapper\">\r\n            <div class=\"icon-speak-wrapper\">\r\n              <span class=\"icon-speak\"></span>\r\n            </div>\r\n            <div class=\"speak-title-wrapper\">\r\n              <span class=\"speak-title\">{{$t('speak.voice')}}</span>\r\n            </div>\r\n            <div class=\"read-fulltext-wrapper\">\r\n              <span class=\"read-fulltext\">{{$t('speak.read')}}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-section-title-wrapper\">\r\n            <div class=\"card-section-title-text\">{{title}}</div>\r\n            <div class=\"card-section-sub-title-text\" v-if=\"currentSectionIndex\">{{currentSectionIndex}} /\r\n              {{currentSectionTotal}}\r\n            </div>\r\n          </div>\r\n          <div class=\"setting-progress\">\r\n            <div class=\"progress-wrapper\">\r\n              <input class=\"progress\" type=\"range\"\r\n                     max=\"100\"\r\n                     min=\"0\"\r\n                     step=\"1\"\r\n                     @change=\"onProgressChange($event.target.value)\"\r\n                     @input=\"onProgressInput($event.target.value)\"\r\n                     :value=\"progress\"\r\n                     ref=\"progress\">\r\n            </div>\r\n            <div class=\"progress-text\">\r\n              <div class=\"progress-text-current\">{{playInfo ? playInfo.currentMinute : '00'}}:{{playInfo ?\r\n                playInfo.currentSecond : '00'}}\r\n              </div>\r\n              <div class=\"progress-text-left\">-{{playInfo ? playInfo.leftMinute : '00'}}:{{playInfo ?\r\n                playInfo.leftSecond : '00'}}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"playing-wrapper\">\r\n            <div class=\"icon-settings-wrapper\">\r\n              <span class=\"icon-settings\"></span>\r\n              <div class=\"settings-text\">{{$t('speak.settings')}}</div>\r\n            </div>\r\n            <span class=\"icon-play_backward\" :class=\"{'not-use': currentSectionIndex <= 1}\" @click.stop.prevent=\"prev\"></span>\r\n            <div class=\"icon-play-wrapper\" @click.stop.prevent=\"togglePlay\">\r\n              <span class=\"icon-play_go\" v-if=\"!isPlaying\"></span>\r\n              <span class=\"icon-play_pause\" v-else></span>\r\n            </div>\r\n            <span class=\"icon-play_forward\" :class=\"{'not-use': currentSectionIndex >= currentSectionTotal}\"\r\n                  @click.stop.prevent=\"next\"></span>\r\n            <div class=\"icon-clock-wrapper\">\r\n              <span class=\"icon-clock\"></span>\r\n              <div class=\"clock-text\">{{$t('speak.timing')}}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"read-apply-wrapper\">\r\n            {{$t('speak.apply')}}\r\n          </div>\r\n          <div class=\"read-title-wrapper\">\r\n            <span class=\"line\"></span>\r\n            <div class=\"read-title-text\">{{$t('speak.current')}}</div>\r\n            <span class=\"line\"></span>\r\n          </div>\r\n          <div class=\"book-wrapper\" ref=\"bookWrapper\">\r\n            <div id=\"book-read\"></div>\r\n          </div>\r\n        </div>\r\n      </transition>\r\n    </div>\r\n  </transition>\r\n</template>\r\n\r\n<script>\r\n  import { realPx } from '@/utils/utils'\r\n\r\n  export default {\r\n    props: {\r\n      title: String,\r\n      book: Object,\r\n      section: Object,\r\n      currentSectionIndex: Number,\r\n      currentSectionTotal: Number,\r\n      isPlaying: Boolean,\r\n      playInfo: Object\r\n    },\r\n    data() {\r\n      return {\r\n        visible: false,\r\n        speakCardVisible: false,\r\n        progress: 0,\r\n        readHeight: 0\r\n      }\r\n    },\r\n    methods: {\r\n      refreshProgress(p) {\r\n        this.progress = p\r\n        this.$refs.progress.style.backgroundSize = `${this.progress}% 100%`\r\n      },\r\n      updateText(promise) {\r\n        promise.then(() => {\r\n          const currentPage = this.rendition.currentLocation()\r\n          const cfibase = this.section.cfiBase\r\n          const cfistart = currentPage.start.cfi.replace(/.*!/, '').replace(/\\)/, '')\r\n          const cfiend = currentPage.end.cfi.replace(/.*!/, '').replace(/\\)/, '')\r\n          this.book.getRange(`epubcfi(${cfibase}!,${cfistart},${cfiend})`).then(range => {\r\n            let text = range.toString()\r\n            text = text.replace(/\\s(2,)/g, '')\r\n            text = text.replace(/\\r/g, '')\r\n            text = text.replace(/\\n/g, '')\r\n            text = text.replace(/\\t/g, '')\r\n            text = text.replace(/\\f/g, '')\r\n            this.$emit('updateText', text)\r\n          })\r\n        })\r\n      },\r\n      togglePlay() {\r\n        this.$parent.togglePlay()\r\n      },\r\n      prev() {\r\n        if (this.currentSectionIndex > 1) {\r\n          this.updateText(this.rendition.prev())\r\n          this.$emit('update:currentSectionIndex', this.currentSectionIndex - 1)\r\n          this.$parent.resetPlay()\r\n          setTimeout(() => {\r\n            this.$parent.togglePlay()\r\n          }, 500)\r\n        }\r\n      },\r\n      next() {\r\n        if (this.currentSectionIndex < this.currentSectionTotal) {\r\n          this.updateText(this.rendition.next())\r\n          this.$emit('update:currentSectionIndex', this.currentSectionIndex + 1)\r\n          this.$parent.resetPlay()\r\n          setTimeout(() => {\r\n            this.$parent.togglePlay()\r\n          }, 500)\r\n        }\r\n      },\r\n      display() {\r\n        if (!this.rendition) {\r\n          this.rendition = this.book.renderTo('book-read', {\r\n            width: window.innerWidth > 640 ? 640 : window.innerWidth,\r\n            height: this.readHeight,\r\n            method: 'default'\r\n          })\r\n          this.displayed = this.rendition.display(this.section.href)\r\n        } else {\r\n          this.displayed = this.rendition.display(this.section.href)\r\n        }\r\n      },\r\n      onProgressChange(progress) {\r\n      },\r\n      onProgressInput(progress) {\r\n        this.progress = progress\r\n        this.$refs.progress.style.backgroundSize = `${this.progress}% 100%`\r\n      },\r\n      hide() {\r\n        this.speakCardVisible = false\r\n        this.visible = false\r\n      },\r\n      show() {\r\n        this.visible = true\r\n        this.speakCardVisible = true\r\n        this.refresh()\r\n        this.$nextTick(() => {\r\n          this.display()\r\n        })\r\n      },\r\n      refresh() {\r\n        this.readHeight = window.innerHeight * 0.9 - realPx(40) - realPx(54) - realPx(46) - realPx(48) - realPx(60) - realPx(44)\r\n        // console.log(this.readHeight)\r\n        this.$refs.bookWrapper.style.height = this.readHeight + 'px'\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import \"../../assets/styles/global\";\r\n\r\n  .book-speak-mask-wrapper {\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 120;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(0, 0, 0, .5);\r\n    .book-speak-mask-card-wrapper {\r\n      position: absolute;\r\n      bottom: 0;\r\n      left: 0;\r\n      z-index: 120;\r\n      width: 100%;\r\n      height: 90%;\r\n      background: white;\r\n      border-radius: px2rem(10) px2rem(10) 0 0;\r\n      .pulldown-icon-wrapper {\r\n        width: 100%;\r\n        height: px2rem(40);\r\n        color: #ccc;\r\n        font-size: px2rem(40);\r\n        @include center;\r\n      }\r\n      .card-title-wrapper {\r\n        width: 100%;\r\n        height: px2rem(54);\r\n        display: flex;\r\n        padding: 0 px2rem(15);\r\n        box-sizing: border-box;\r\n        .icon-speak-wrapper {\r\n          flex: 0 0 px2rem(40);\r\n          @include left;\r\n          .icon-speak {\r\n            font-size: px2rem(24);\r\n            color: #999;\r\n          }\r\n        }\r\n        .speak-title-wrapper {\r\n          flex: 1;\r\n          @include left;\r\n          .speak-title {\r\n            font-size: px2rem(16);\r\n            font-weight: bold;\r\n            color: #666;\r\n          }\r\n        }\r\n        .read-fulltext-wrapper {\r\n          flex: 1;\r\n          @include right;\r\n          .read-fulltext {\r\n            font-size: px2rem(12);\r\n            font-weight: bold;\r\n            color: $color-blue;\r\n            background: rgba(74, 171, 255, .2);\r\n            padding: px2rem(5) px2rem(10);\r\n            box-sizing: border-box;\r\n            border-radius: px2rem(20);\r\n          }\r\n        }\r\n      }\r\n      .card-section-title-wrapper {\r\n        width: 100%;\r\n        height: px2rem(46);\r\n        padding: 0 px2rem(15);\r\n        box-sizing: border-box;\r\n        @include columnCenter;\r\n        .card-section-title-text {\r\n          font-size: px2rem(16);\r\n          color: #333;\r\n          font-weight: bold;\r\n        }\r\n        .card-section-sub-title-text {\r\n          font-size: px2rem(12);\r\n          color: #666;\r\n          margin-top: px2rem(5);\r\n        }\r\n      }\r\n      .setting-progress {\r\n        width: 100%;\r\n        height: px2rem(48);\r\n        @include columnTop;\r\n        .progress-wrapper {\r\n          flex: 1;\r\n          width: 100%;\r\n          @include center;\r\n          padding: 0 px2rem(30);\r\n          box-sizing: border-box;\r\n          .progress {\r\n            width: 100%;\r\n            -webkit-appearance: none;\r\n            height: px2rem(2);\r\n            background: -webkit-linear-gradient($color-blue, $color-blue) no-repeat, rgba(74, 171, 255, .2);\r\n            background-size: 0 100%;\r\n            &:focus {\r\n              outline: none;\r\n            }\r\n            &::-webkit-slider-thumb {\r\n              -webkit-appearance: none;\r\n              height: px2rem(20);\r\n              width: px2rem(20);\r\n              border-radius: 50%;\r\n              background: $color-blue;\r\n              border: none;\r\n              box-shadow: 0 4px 4px 0 rgba(0, 0, 0, .15);\r\n            }\r\n          }\r\n        }\r\n        .progress-text {\r\n          display: flex;\r\n          width: 100%;\r\n          padding: 0 px2rem(30);\r\n          box-sizing: border-box;\r\n          .progress-text-current {\r\n            flex: 1;\r\n            text-align: left;\r\n            font-size: px2rem(10);\r\n            color: #666;\r\n          }\r\n          .progress-text-left {\r\n            flex: 1;\r\n            text-align: right;\r\n            font-size: px2rem(10);\r\n            color: #666;\r\n          }\r\n        }\r\n      }\r\n      .playing-wrapper {\r\n        width: 100%;\r\n        height: px2rem(60);\r\n        @include center;\r\n        .icon-settings-wrapper {\r\n          flex: 1;\r\n          @include columnCenter;\r\n          .icon-settings {\r\n            font-size: px2rem(18);\r\n            color: #666;\r\n          }\r\n          .settings-text {\r\n            margin-top: px2rem(5);\r\n            font-size: px2rem(10);\r\n            color: #666;\r\n          }\r\n        }\r\n        .icon-play_backward {\r\n          font-size: px2rem(30);\r\n          color: $color-blue;\r\n          &:active {\r\n            opacity: .5;\r\n          }\r\n          &.not-use {\r\n            color: $color-blue-transparent;\r\n          }\r\n        }\r\n        .icon-play-wrapper {\r\n          flex: 0 0 px2rem(100);\r\n          @include center;\r\n          &:active {\r\n            opacity: .5;\r\n          }\r\n          .icon-play_go {\r\n            font-size: px2rem(50);\r\n            color: $color-blue;\r\n          }\r\n          .icon-play_pause {\r\n            font-size: px2rem(50);\r\n            color: $color-blue;\r\n          }\r\n        }\r\n        .icon-play_forward {\r\n          font-size: px2rem(30);\r\n          color: $color-blue;\r\n          &:active {\r\n            opacity: .5;\r\n          }\r\n          &.not-use {\r\n            color: $color-blue-transparent;\r\n          }\r\n        }\r\n        .icon-clock-wrapper {\r\n          flex: 1;\r\n          @include columnCenter;\r\n          .icon-clock2 {\r\n            font-size: px2rem(18);\r\n            color: #666;\r\n          }\r\n          .clock-text {\r\n            margin-top: px2rem(5);\r\n            font-size: px2rem(10);\r\n            color: #666;\r\n          }\r\n        }\r\n      }\r\n      .read-apply-wrapper {\r\n        width: 100%;\r\n        height: px2rem(20);\r\n        font-size: px2rem(10);\r\n        color: $color-green;\r\n        @include center;\r\n      }\r\n      .read-title-wrapper {\r\n        width: 100%;\r\n        height: px2rem(24);\r\n        box-sizing: border-box;\r\n        @include center;\r\n        .line {\r\n          flex: 1;\r\n          border-top: px2rem(1) solid #eee;\r\n          height: 0;\r\n        }\r\n        .read-title-text {\r\n          flex: 0 0 px2rem(130);\r\n          font-size: px2rem(14);\r\n          color: #666;\r\n          text-align: center;\r\n        }\r\n      }\r\n      .book-wrapper {\r\n        #read {\r\n          width: 100%;\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakMask.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakMask.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpeakMask.vue?vue&type=template&id=90471c68&scoped=true&\"\nimport script from \"./SpeakMask.vue?vue&type=script&lang=js&\"\nexport * from \"./SpeakMask.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpeakMask.vue?vue&type=style&index=0&id=90471c68&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"90471c68\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@10.1.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./StoreSpeaking.vue?vue&type=style&index=0&id=c11b9fb8&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@10.1.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakPlaying.vue?vue&type=style&index=0&id=0f3d8204&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"","<!-- 听书组件 -->\r\n<template>\r\n  <div class=\"book-speaking\">\r\n    <detail-title @back=\"back\" ref=\"title\"></detail-title>\r\n    <scroll class=\"content-wrapper\"\r\n            :top=\"42\"\r\n            :bottom=\"scrollBottom\"\r\n            :ifNoScroll=\"disableScroll\"\r\n            @onScroll=\"onScroll\"\r\n            ref=\"scroll\">\r\n      <book-info :cover=\"cover\"\r\n                 :title=\"title\"\r\n                 :author=\"author\"\r\n                 :desc=\"desc\"></book-info>\r\n      <div class=\"book-speak-title-wrapper\">\r\n        <div class=\"icon-speak-wrapper\">\r\n          <span class=\"icon-speak\"></span>\r\n        </div>\r\n        <div class=\"speak-title-wrapper\">\r\n          <span class=\"speak-title\">{{$t('speak.voice')}}</span>\r\n        </div>\r\n        <div class=\"icon-down-wrapper\" @click=\"toggleContent\">\r\n          <span :class=\"{'icon-down2': !ifShowContent, 'icon-up': ifShowContent}\"></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"book-detail-content-wrapper\" v-show=\"ifShowContent\">\r\n        <div class=\"book-detail-content-list-wrapper\">\r\n          <div class=\"loading-text-wrapper\" v-if=\"!this.navigation\">\r\n            <span class=\"loading-text\">{{$t('detail.loading')}}</span>\r\n          </div>\r\n          <div class=\"book-detail-content-item-wrapper\">\r\n            <div class=\"book-detail-content-item\" v-for=\"(item, index) in flatNavigation\" :key=\"index\"\r\n                 @click=\"speak(item, index)\">\r\n              <speak-playing v-if=\"playingIndex === index\"\r\n                             :number=\"5\"\r\n                             ref=\"speakPlaying\"></speak-playing>\r\n              <div class=\"book-detail-content-navigation-text\" :class=\"{'is-playing': playingIndex === index}\"\r\n                   v-if=\"item.label\">{{item.label}}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <audio @canplay=\"onCanPlay\"\r\n             @timeupdate=\"onTimeUpdate\"\r\n             @ended=\"onAudioEnded\"\r\n             ref=\"audio\"></audio>\r\n    </scroll>\r\n    <bottom :chapter=\"chapter\"\r\n            :currentSectionIndex=\"currentSectionIndex\"\r\n            :currentSectionTotal=\"currentSectionTotal\"\r\n            :showPlay=\"showPlay\"\r\n            :isPlaying.sync=\"isPlaying\"\r\n            :playInfo=\"playInfo\"\r\n            :inBookShelf='inBookShelf'\r\n            @onPlayingCardClick=\"onPlayingCardClick\"></bottom>\r\n    <div class=\"book-wrapper\">\r\n      <div id=\"read\"></div>\r\n    </div>\r\n    <speak-window :title=\"this.chapter ? this.chapter.label : ''\"\r\n                  :book=\"book\"\r\n                  :section=\"section\"\r\n                  :currentSectionIndex.sync=\"currentSectionIndex\"\r\n                  :currentSectionTotal=\"currentSectionTotal\"\r\n                  :isPlaying.sync=\"isPlaying\"\r\n                  :playInfo=\"playInfo\"\r\n                  @updateText=\"updateText\"\r\n                  ref=\"speakWindow\"\r\n    ></speak-window>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\n  import DetailTitle from '../../components/detail/DetaiTitle'\r\n  import BookInfo from '../../components/detail/BookInfo'\r\n  import Scroll from '../../components/common/Scroll'\r\n  import SpeakPlaying from '../../components/speak/SpeakPlaying'\r\n  import Bottom from '../../components/speak/SpeakBottom'\r\n  import SpeakWindow from '../../components/speak/SpeakMask'\r\n  import { findBook, getCategoryName, inBookShelf, addOrRemoveShelf } from '../../utils/store'\r\n  import { getBookShelf/* , saveBookShelf */ } from '../../utils/localStorage'\r\n  import { flatList } from '../../api/store'\r\n  import { getLocalForage } from '../../utils/localForage'\r\n  import { realPx } from '../../utils/utils'\r\n  import Epub from 'epubjs'\r\n\r\n  global.ePub = Epub\r\n\r\n  export default {\r\n    components: {\r\n      DetailTitle,\r\n      BookInfo,\r\n      Scroll,\r\n      SpeakPlaying,\r\n      Bottom,\r\n      SpeakWindow\r\n    },\r\n    computed: {\r\n      // 本书在不在书架\r\n      inBookShelf() {\r\n        return inBookShelf(this.bookItem, this.bookList)\r\n      },\r\n      // 音频当前播放的分钟数\r\n      currentMinute() {\r\n        const m = Math.floor(this.currentPlayingTime / 60)\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频当前播放的秒数\r\n      currentSecond() {\r\n        const s = Math.floor(this.currentPlayingTime - parseInt(this.currentMinute) * 60)\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 音频的总时长\r\n      totalMinute() {\r\n        const m = Math.floor(this.totalPlayingTime / 60)\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频的总秒数\r\n      totalSecond() {\r\n        const s = Math.floor(this.totalPlayingTime - parseInt(this.totalMinute) * 60)\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 音频的剩余分钟数\r\n      leftMinute() {\r\n        const m = Math.floor((this.totalPlayingTime - this.currentPlayingTime) / 60)\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频的剩余秒数\r\n      leftSecond() {\r\n        const s = Math.floor((this.totalPlayingTime - this.currentPlayingTime) - parseInt(this.leftMinute) * 60)\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 播放信息对象\r\n      playInfo() {\r\n        if (this.audioCanPlay) {\r\n          return {\r\n            currentMinute: this.currentMinute,\r\n            currentSecond: this.currentSecond,\r\n            totalMinute: this.totalMinute,\r\n            totalSecond: this.totalSecond,\r\n            leftMinute: this.leftMinute,\r\n            leftSecond: this.leftSecond\r\n          }\r\n        } else {\r\n          return null\r\n        }\r\n      },\r\n      // 电子书的语种\r\n      lang() {\r\n        return this.metadata ? this.metadata.language : ''\r\n      },\r\n      // 当播放面板显示时，禁用滚动条（解决事件穿透问题）\r\n      disableScroll() {\r\n        if (this.$refs.speakWindow) {\r\n          return this.$refs.speakWindow.visible\r\n        } else {\r\n          return false\r\n        }\r\n      },\r\n      // 是否底部的播放面板\r\n      showPlay() {\r\n        return this.playingIndex >= 0\r\n      },\r\n      // 滚动条距底部距离，当显示播放面板时为116像素，不显示时为52像素\r\n      scrollBottom() {\r\n        return this.showPlay ? 116 : 52\r\n      },\r\n      // 当前章节信息\r\n      chapter() {\r\n        return this.flatNavigation[this.playingIndex]\r\n      },\r\n      // 电子书摘要信息\r\n      desc() {\r\n        if (this.description) {\r\n          return this.description.substring(0, 100)\r\n        } else {\r\n          return ''\r\n        }\r\n      },\r\n      // 一维数组的目录\r\n      flatNavigation() {\r\n        if (this.navigation) {\r\n          return Array.prototype.concat.apply([], Array.prototype.concat.apply([], this.doFlatNavigation(this.navigation.toc)))\r\n        } else {\r\n          return []\r\n        }\r\n      },\r\n      // 电子书分类\r\n      category() {\r\n        return this.bookItem ? getCategoryName(this.bookItem.category) : ''\r\n      },\r\n      // 电子书书名\r\n      title() {\r\n        return this.metadata ? this.metadata.title : ''\r\n      },\r\n      // 电子书作者\r\n      author() {\r\n        return this.metadata ? this.metadata.creator : ''\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        bookList: '',\r\n        bookItem: null,\r\n        book: null,\r\n        rendition: null,\r\n        metadata: null,\r\n        cover: null,\r\n        navigation: null,\r\n        description: null,\r\n        ifShowContent: true,\r\n        playingIndex: -1,\r\n        paragraph: null,\r\n        currentSectionIndex: null,\r\n        currentSectionTotal: null,\r\n        section: null,\r\n        isPlaying: false,\r\n        audio: null,\r\n        audioCanPlay: false,\r\n        currentPlayingTime: 0,\r\n        totalPlayingTime: 0,\r\n        playStatus: 0, // 0 - 未播放，1 - 播放中，2 - 暂停中\r\n        toastText: '',\r\n        isOnline: false\r\n      }\r\n    },\r\n    methods: {\r\n      addOrRemoveShelf() {\r\n        addOrRemoveShelf(this.inBookShelf, this.bookItem, this.bookList)\r\n        this.bookList = getBookShelf()\r\n      },\r\n      // 在线语音合成\r\n      createVoice(text) {\r\n        // const experience = new Experience({\r\n        //   speed: 50,\r\n        //   voice: 50,\r\n        //   pitch: 50,\r\n        //   playBtn: '.audio-ctrl-btn'\r\n        // })\r\n        // console.log('在线语音合成', text)\r\n        // if (text !== experience.text) {\r\n        //   experience.setConfig({\r\n        //     text\r\n        //   })\r\n        // }\r\n        // console.log(experience)\r\n        // if (experience.playState === 'play') {\r\n        //   experience.audioPause()\r\n        //   this.resetPlay()\r\n        // } else {\r\n        //   experience.audioPlay()\r\n        //   this.isPlaying = true\r\n        //   this.playStatus = 1\r\n        // }\r\n        const xmlhttp = new XMLHttpRequest()\r\n        // 创建HTTP请求，同步接收结果\r\n        xmlhttp.open('GET', `${process.env.VUE_APP_VOICE_URL}/voice?text=${text}&lang=${this.lang.toLowerCase()}`, false)\r\n        // 发送请求\r\n        xmlhttp.send()\r\n        // 获取响应内容\r\n        const xmlDoc = xmlhttp.responseText\r\n        if (xmlDoc) {\r\n          // 解析响应内容\r\n          const json = JSON.parse(xmlDoc)\r\n          if (json.path) {\r\n            // path为语音合成生成的MP3文件下载路径，将该路径赋值audio.src\r\n            // audio控件会自动加载音频文件\r\n            this.$refs.audio.src = json.path\r\n            // 自动播放MP3\r\n            this.continuePlay()\r\n          } else {\r\n            this.showToast('播放失败，未生成链接')\r\n          }\r\n        } else {\r\n          this.showToast('播放失败')\r\n        }\r\n      },\r\n      // 切换播放状态，如果处于播放状态则暂停，如果处于暂停状态，则播放\r\n      // 注意状态0和状态2是不通的\r\n      // 状态0 表示还未播放，所以需要先进行语音合成\r\n      // 状态2 表示已经合成，所以直接进行播放即可\r\n      togglePlay() {\r\n        if (!this.isPlaying) {\r\n          if (this.playStatus === 0) {\r\n            this.play()\r\n          } else if (this.playStatus === 2) {\r\n            this.continuePlay()\r\n          }\r\n        } else {\r\n          this.pausePlay()\r\n        }\r\n      },\r\n      // 生成语音合成的文本信息\r\n      speak(item, index) {\r\n        // 重置播放状态，停止一切播放\r\n        this.resetPlay()\r\n        this.playingIndex = index\r\n        this.$nextTick(() => {\r\n          this.$refs.scroll.refresh()\r\n          if (this.chapter) {\r\n            // 获取当前点击的章节信息\r\n            this.section = this.book.spine.get(this.chapter.href)\r\n            // 渲染章节\r\n            this.rendition.display(this.section.href).then(section => {\r\n              // 获取当前位置对象\r\n              const currentPage = this.rendition.currentLocation()\r\n              const cfibase = section.cfiBase\r\n              const cfistart = currentPage.start.cfi.replace(/.*!/, '').replace(/\\)/, '')\r\n              const cfiend = currentPage.end.cfi.replace(/.*!/, '').replace(/\\)/, '')\r\n              this.currentSectionIndex = currentPage.start.displayed.page\r\n              this.currentSectionTotal = currentPage.start.displayed.total\r\n              // 合成cfi信息\r\n              const cfi = `epubcfi(${cfibase}!,${cfistart},${cfiend})`\r\n              // console.log(currentPage, cfi, cfibase, cfistart, cfiend)\r\n              // 通过Book.getRange(cfi)方法获取指定片段的cfi对应的文本\r\n              this.book.getRange(cfi).then(range => {\r\n                // 获取章节片段的文本信息\r\n                let text = range.toLocaleString()\r\n                // 对文本信息进行过滤，去除其中的空格（注意是2个空格，1个空格是合理的）、换行符等特殊字符\r\n                text = text.replace(/\\s(2,)/g, '')\r\n                text = text.replace(/\\r/g, '')\r\n                text = text.replace(/\\n/g, '')\r\n                text = text.replace(/\\t/g, '')\r\n                text = text.replace(/\\f/g, '')\r\n                // 更新语音合成的文本信息\r\n                this.updateText(text)\r\n              })\r\n            })\r\n          }\r\n        })\r\n      },\r\n      // 重置播放状态\r\n      resetPlay() {\r\n        if (this.playStatus === 1) {\r\n          this.pausePlay()\r\n        }\r\n        this.isPlaying = false\r\n        this.playStatus = 0\r\n      },\r\n      // 从头开始语音合成并播放\r\n      play() {\r\n        this.createVoice(this.paragraph)\r\n      },\r\n      // 继续播放\r\n      continuePlay() {\r\n        this.$refs.audio.play().then(() => {\r\n          // 显示播放动画\r\n          this.$refs.speakPlaying[0].startAnimation()\r\n          this.isPlaying = true\r\n          this.playStatus = 1\r\n        })\r\n      },\r\n      // 暂停播放\r\n      pausePlay() {\r\n        this.$refs.audio.pause()\r\n        // 暂停播放动画\r\n        this.$refs.speakPlaying[0].stopAnimation()\r\n        this.isPlaying = false\r\n        this.playStatus = 2\r\n      },\r\n      // 当播放结束时，刷新播放信息\r\n      onAudioEnded() {\r\n        this.resetPlay()\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        const percent = Math.floor((this.currentPlayingTime / this.totalPlayingTime) * 100)\r\n        this.$refs.speakWindow.refreshProgress(percent)\r\n      },\r\n      // 当播放进行时，刷新播放信息\r\n      onTimeUpdate() {\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        const percent = Math.floor((this.currentPlayingTime / this.totalPlayingTime) * 100)\r\n        this.$refs.speakWindow.refreshProgress(percent)\r\n      },\r\n      // 调用audio.src时，audio控件会调用canplay事件\r\n      // 此时我们可以获取总播放时长和当前播放时长\r\n      onCanPlay() {\r\n        this.audioCanPlay = true\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        this.totalPlayingTime = this.$refs.audio.duration\r\n      },\r\n      // 通过API找到当前电子书的详情数据\r\n      findBookFromList(fileName) {\r\n        flatList().then(response => {\r\n          if (response.status === 200) {\r\n            const bookList = response.data.data.filter(item => item.fileName === fileName)\r\n            if (bookList && bookList.length > 0) {\r\n              this.bookItem = bookList[0]\r\n              this.init()\r\n            }\r\n          }\r\n        })\r\n      },\r\n      // 初始化参数信息\r\n      init() {\r\n        const fileName = this.$route.query.fileName\r\n        // 获取本地书架\r\n        this.bookList = getBookShelf()\r\n        if (!this.bookItem) {\r\n          this.bookItem = findBook(fileName)\r\n        }\r\n        if (this.bookItem) {\r\n          // 如果电子书已经缓存，则直接从IndexedDB数据库中获取\r\n          getLocalForage(fileName, (err, blob) => {\r\n            if (err || !blob) {\r\n              // 如果获取缓存失败，则拼接opf文件来获取电子书\r\n              this.isOnline = true\r\n              const opf = this.$route.query.opf\r\n              if (opf) {\r\n                this.parseBook(opf)\r\n              }\r\n            } else {\r\n              this.isOnline = false\r\n              // 解析电子书\r\n              this.parseBook(blob)\r\n            }\r\n          })\r\n        } else {\r\n          this.findBookFromList(fileName)\r\n        }\r\n      },\r\n      // 解析电子书\r\n      parseBook(blob) {\r\n        // 解析电子书\r\n        this.book = new Epub(blob)\r\n        // 获取电子书的metadata\r\n        this.book.loaded.metadata.then(metadata => {\r\n          this.metadata = metadata\r\n        })\r\n        // 如果是在线获取的电子书，则通过Book.coverUrl()方法获取封面链接\r\n        if (this.isOnline) {\r\n          this.book.coverUrl().then(url => {\r\n            this.cover = url\r\n          })\r\n        } else {\r\n          // 如果是本地获取的电子书，通过Book.loaded.cover方法获取封面链接（加快封面获取速度）\r\n          this.book.loaded.cover.then(cover => {\r\n            this.book.archive.createUrl(cover).then(url => {\r\n              this.cover = url\r\n            })\r\n          })\r\n        }\r\n        // 获取电子书的目录信息\r\n        this.book.loaded.navigation.then(nav => {\r\n          this.navigation = nav\r\n        })\r\n        // 渲染电子书\r\n        this.display()\r\n      },\r\n      back() {\r\n        this.$router.go(-1)\r\n      },\r\n      // 处理滚动条的事件，决定标题阴影是否展示\r\n      onScroll(offsetY) {\r\n        if (offsetY > realPx(42)) {\r\n          this.$refs.title.showShadow()\r\n        } else {\r\n          this.$refs.title.hideShadow()\r\n        }\r\n      },\r\n      toggleContent() {\r\n        this.ifShowContent = !this.ifShowContent\r\n      },\r\n      // 渲染电子书\r\n      display() {\r\n        const height = window.innerHeight * 0.9 - realPx(40) - realPx(54) - realPx(46) - realPx(48) - realPx(60) - realPx(44)\r\n        this.rendition = this.book.renderTo('read', {\r\n          width: window.innerWidth,\r\n          height: height,\r\n          method: 'default'\r\n        })\r\n        this.rendition.display()\r\n      },\r\n      doFlatNavigation(content, deep = 1) {\r\n        const arr = []\r\n        content.forEach(item => {\r\n          item.deep = deep\r\n          arr.push(item)\r\n          if (item.subitems && item.subitems.length > 0) {\r\n            arr.push(this.doFlatNavigation(item.subitems, deep + 1))\r\n          }\r\n        })\r\n        return arr\r\n      },\r\n      showToast(text) {\r\n        this.simpleToast(text)\r\n      },\r\n      onPlayingCardClick() {\r\n        this.$refs.speakWindow.show()\r\n      },\r\n      updateText(text) {\r\n        this.paragraph = text\r\n      }\r\n    },\r\n    mounted() {\r\n      this.init()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import \"../../assets/styles/global\";\r\n\r\n  .book-speaking {\r\n    font-size: px2rem(16);\r\n    width: 100%;\r\n    background: white;\r\n\r\n    .content-wrapper {\r\n      width: 100%;\r\n\r\n      .book-speak-title-wrapper {\r\n        display: flex;\r\n        padding: px2rem(15);\r\n        box-sizing: border-box;\r\n        border-bottom: px2rem(1) solid #eee;\r\n\r\n        .icon-speak-wrapper {\r\n          flex: 0 0 px2rem(40);\r\n          @include left;\r\n\r\n          .icon-speak {\r\n            font-size: px2rem(24);\r\n            color: #999;\r\n          }\r\n        }\r\n\r\n        .speak-title-wrapper {\r\n          flex: 1;\r\n          @include left;\r\n\r\n          .speak-title {\r\n            font-size: px2rem(16);\r\n            font-weight: bold;\r\n            color: #666;\r\n          }\r\n        }\r\n\r\n        .icon-down-wrapper {\r\n          flex: 0 0 px2rem(40);\r\n          @include right;\r\n\r\n          .icon-up {\r\n            font-size: px2rem(12);\r\n            color: #999;\r\n          }\r\n\r\n          .icon-down2 {\r\n            font-size: px2rem(12);\r\n            color: #999;\r\n          }\r\n        }\r\n      }\r\n\r\n      .book-detail-content-wrapper {\r\n        width: 100%;\r\n        border-bottom: px2rem(1) solid #eee;\r\n        box-sizing: border-box;\r\n\r\n        .book-detail-content-list-wrapper {\r\n          padding: px2rem(10) px2rem(15);\r\n\r\n          .loading-text-wrapper {\r\n            width: 100%;\r\n\r\n            .loading-text {\r\n              font-size: px2rem(14);\r\n              color: #999;\r\n            }\r\n          }\r\n\r\n          .book-detail-content-item-wrapper {\r\n            .book-detail-content-item {\r\n              display: flex;\r\n              padding: px2rem(15) 0;\r\n              font-size: px2rem(14);\r\n              line-height: px2rem(16);\r\n              color: #333;\r\n              border-bottom: px2rem(1) solid #eee;\r\n\r\n              &:last-child {\r\n                border-bottom: none;\r\n              }\r\n\r\n              .book-detail-content-navigation-text {\r\n                flex: 1;\r\n                width: 100%;\r\n                @include ellipsis;\r\n\r\n                &.is-playing {\r\n                  color: $color-blue;\r\n                  font-weight: bold;\r\n                  margin-left: px2rem(10);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .book-wrapper {\r\n      position: absolute;\r\n      bottom: -100%;\r\n      z-index: 100;\r\n    }\r\n  }\r\n</style>\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"playing-item-wrapper\"},_vm._l((_vm.styles),function(item,index){return _c('div',{key:index,ref:\"playingItem\",refInFor:true,staticClass:\"playing-item\",style:(item)})}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"playing-item-wrapper\">\r\n    <div class=\"playing-item\" :style=\"item\" v-for=\"(item, index) in styles\" :key=\"index\" ref=\"playingItem\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { px2rem } from '@/utils/utils'\r\n\r\n  export default {\r\n    props: {\r\n      number: Number\r\n    },\r\n    computed: {\r\n      styles() {\r\n        const styles = new Array(this.number)\r\n        for (let i = 0; i < styles.length; i++) {\r\n          styles[i] = {\r\n            height: px2rem(this.random()) + 'rem'\r\n          }\r\n        }\r\n        return styles\r\n      }\r\n    },\r\n    methods: {\r\n      startAnimation() {\r\n        this.task = setInterval(() => {\r\n          this.$refs.playingItem.forEach(item => {\r\n            item.style.height = px2rem(this.random()) + 'rem'\r\n          })\r\n        }, 200)\r\n      },\r\n      stopAnimation() {\r\n        if (this.task) {\r\n          clearInterval(this.task)\r\n        }\r\n      },\r\n      random() {\r\n        return Math.ceil(Math.random() * 10)\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import \"../../assets/styles/global\";\r\n\r\n  .playing-item-wrapper {\r\n    @include center;\r\n    .playing-item {\r\n      flex: 0 0 px2rem(2);\r\n      width: px2rem(2);\r\n      height: px2rem(1);\r\n      background: $color-blue;\r\n      margin-left: px2rem(2);\r\n      transition: all .2s ease-in-out;\r\n      &:first-child {\r\n        margin: 0;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakPlaying.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakPlaying.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpeakPlaying.vue?vue&type=template&id=0f3d8204&scoped=true&\"\nimport script from \"./SpeakPlaying.vue?vue&type=script&lang=js&\"\nexport * from \"./SpeakPlaying.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpeakPlaying.vue?vue&type=style&index=0&id=0f3d8204&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f3d8204\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@10.1.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./SpeakBottom.vue?vue&type=style&index=0&id=100e51a5&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"book-speaking\"},[_c('detail-title',{ref:\"title\",on:{\"back\":_vm.back}}),_c('scroll',{ref:\"scroll\",staticClass:\"content-wrapper\",attrs:{\"top\":42,\"bottom\":_vm.scrollBottom,\"ifNoScroll\":_vm.disableScroll},on:{\"onScroll\":_vm.onScroll}},[_c('book-info',{attrs:{\"cover\":_vm.cover,\"title\":_vm.title,\"author\":_vm.author,\"desc\":_vm.desc}}),_c('div',{staticClass:\"book-speak-title-wrapper\"},[_c('div',{staticClass:\"icon-speak-wrapper\"},[_c('span',{staticClass:\"icon-speak\"})]),_c('div',{staticClass:\"speak-title-wrapper\"},[_c('span',{staticClass:\"speak-title\"},[_vm._v(_vm._s(_vm.$t('speak.voice')))])]),_c('div',{staticClass:\"icon-down-wrapper\",on:{\"click\":_vm.toggleContent}},[_c('span',{class:{'icon-down2': !_vm.ifShowContent, 'icon-up': _vm.ifShowContent}})])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ifShowContent),expression:\"ifShowContent\"}],staticClass:\"book-detail-content-wrapper\"},[_c('div',{staticClass:\"book-detail-content-list-wrapper\"},[(!this.navigation)?_c('div',{staticClass:\"loading-text-wrapper\"},[_c('span',{staticClass:\"loading-text\"},[_vm._v(_vm._s(_vm.$t('detail.loading')))])]):_vm._e(),_c('div',{staticClass:\"book-detail-content-item-wrapper\"},_vm._l((_vm.flatNavigation),function(item,index){return _c('div',{key:index,staticClass:\"book-detail-content-item\",on:{\"click\":function($event){return _vm.speak(item, index)}}},[(_vm.playingIndex === index)?_c('speak-playing',{ref:\"speakPlaying\",refInFor:true,attrs:{\"number\":5}}):_vm._e(),(item.label)?_c('div',{staticClass:\"book-detail-content-navigation-text\",class:{'is-playing': _vm.playingIndex === index}},[_vm._v(_vm._s(item.label)+\" \")]):_vm._e()],1)}),0)])]),_c('audio',{ref:\"audio\",on:{\"canplay\":_vm.onCanPlay,\"timeupdate\":_vm.onTimeUpdate,\"ended\":_vm.onAudioEnded}})],1),_c('bottom',{attrs:{\"chapter\":_vm.chapter,\"currentSectionIndex\":_vm.currentSectionIndex,\"currentSectionTotal\":_vm.currentSectionTotal,\"showPlay\":_vm.showPlay,\"isPlaying\":_vm.isPlaying,\"playInfo\":_vm.playInfo,\"inBookShelf\":_vm.inBookShelf},on:{\"update:isPlaying\":function($event){_vm.isPlaying=$event},\"update:is-playing\":function($event){_vm.isPlaying=$event},\"onPlayingCardClick\":_vm.onPlayingCardClick}}),_vm._m(0),_c('speak-window',{ref:\"speakWindow\",attrs:{\"title\":this.chapter ? this.chapter.label : '',\"book\":_vm.book,\"section\":_vm.section,\"currentSectionIndex\":_vm.currentSectionIndex,\"currentSectionTotal\":_vm.currentSectionTotal,\"isPlaying\":_vm.isPlaying,\"playInfo\":_vm.playInfo},on:{\"update:currentSectionIndex\":function($event){_vm.currentSectionIndex=$event},\"update:current-section-index\":function($event){_vm.currentSectionIndex=$event},\"update:isPlaying\":function($event){_vm.isPlaying=$event},\"update:is-playing\":function($event){_vm.isPlaying=$event},\"updateText\":_vm.updateText}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"book-wrapper\"},[_c('div',{attrs:{\"id\":\"read\"}})])}]\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./StoreSpeaking.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./StoreSpeaking.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StoreSpeaking.vue?vue&type=template&id=c11b9fb8&scoped=true&\"\nimport script from \"./StoreSpeaking.vue?vue&type=script&lang=js&\"\nexport * from \"./StoreSpeaking.vue?vue&type=script&lang=js&\"\nimport style0 from \"./StoreSpeaking.vue?vue&type=style&index=0&id=c11b9fb8&lang=scss&rel=stylesheet%2Fscss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c11b9fb8\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}